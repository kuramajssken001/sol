-- DB update 2020_09_01_00 -> 2020_09_02_00
DROP PROCEDURE IF EXISTS `updateDb`;
DELIMITER //
CREATE PROCEDURE updateDb ()
proc:BEGIN DECLARE OK VARCHAR(100) DEFAULT 'FALSE';
SELECT COUNT(*) INTO @COLEXISTS
FROM information_schema.COLUMNS
WHERE TABLE_SCHEMA = DATABASE() AND TABLE_NAME = 'version_db_sol_world' AND COLUMN_NAME = '2020_09_01_00';
IF @COLEXISTS = 0 THEN LEAVE proc; END IF;
START TRANSACTION;
ALTER TABLE version_db_sol_world CHANGE COLUMN 2020_09_01_00 2020_09_02_00 bit;
SELECT sql_rev INTO OK FROM version_db_sol_world WHERE sql_rev = '1599027909803394700'; IF OK <> 'FALSE' THEN LEAVE proc; END IF;
--
-- START UPDATING QUERIES
--

INSERT INTO `version_db_sol_world` (`sql_rev`) VALUES ('1599027909803394700');

DELETE FROM `creature_formations` WHERE `leaderGUID` = 80849;
INSERT INTO `creature_formations` (`leaderGUID`, `memberGUID`, `dist`, `angle`, `groupAI`)
VALUES
(80849,80849,0,0,2),
(80849,80850,2,135,2),
(80849,80848,2,225,2);

UPDATE `creature` SET `MovementType` = 2 WHERE `guid` = 80849;
DELETE FROM `creature_addon` WHERE `guid` = 80849;
INSERT INTO `creature_addon` (`guid`, `path_id`, `mount`, `bytes1`, `bytes2`, `emote`, `isLarge`, `auras`)
VALUES
(80849,808490,0,0,0,0,0,NULL);

DELETE FROM `waypoint_data` WHERE `id` = 808490;
INSERT INTO `waypoint_data` (`id`, `point`, `position_x`, `position_y`, `position_z`, `orientation`, `delay`, `move_type`, `action`, `action_chance`, `wpguid`)
VALUES
(808490,1,-9773.94,-882.495,39.5058,0,0,0,0,100,0),
(808490,2,-9782.06,-881.679,39.5771,0,0,0,0,100,0),
(808490,3,-9793.54,-874.969,39.6378,0,0,0,0,100,0),
(808490,4,-9802.58,-868.77,39.6113,0,0,0,0,100,0),
(808490,5,-9811.37,-864.751,39.678,0,0,0,0,100,0),
(808490,6,-9819.34,-866.563,39.7273,0,0,0,0,100,0),
(808490,7,-9822.06,-872.371,39.7756,0,0,0,0,100,0),
(808490,8,-9821,-880.579,39.6681,0,0,0,0,100,0),
(808490,9,-9817.45,-888.735,39.3795,0,0,0,0,100,0),
(808490,10,-9810.88,-893.692,39.4414,0,0,0,0,100,0),
(808490,11,-9802.38,-897.791,39.7562,0,0,0,0,100,0),
(808490,12,-9794.14,-899.775,40.0432,0,0,0,0,100,0),
(808490,13,-9784.13,-902.025,40.0471,0,0,0,0,100,0),
(808490,14,-9775.43,-904.313,39.8569,0,0,0,0,100,0),
(808490,15,-9765.84,-906.838,39.7101,0,0,0,0,100,0),
(808490,16,-9758.63,-906.653,39.4842,0,0,0,0,100,0),
(808490,17,-9751.48,-902.401,39.291,0,0,0,0,100,0),
(808490,18,-9745.22,-896.16,39.4587,0,0,0,0,100,0),
(808490,19,-9742.18,-889.557,39.7061,0,0,0,0,100,0),
(808490,20,-9744.41,-883.048,39.7326,0,0,0,0,100,0),
(808490,21,-9747.5,-874.74,39.6514,0,0,0,0,100,0),
(808490,22,-9744.93,-868.113,39.5668,0,0,0,0,100,0),
(808490,23,-9743.68,-860.55,39.4095,0,0,0,0,100,0),
(808490,24,-9745.31,-852.903,39.3431,0,0,0,0,100,0),
(808490,25,-9747.83,-845.42,39.3512,0,0,0,0,100,0),
(808490,26,-9754.72,-838.008,39.2963,0,0,0,0,100,0),
(808490,27,-9763.16,-833.5,39.3574,0,0,0,0,100,0),
(808490,28,-9771.25,-832.679,39.7472,0,0,0,0,100,0),
(808490,29,-9780.65,-836.057,39.9697,0,0,0,0,100,0),
(808490,30,-9789.51,-841.086,39.5193,0,0,0,0,100,0),
(808490,31,-9796.55,-845.856,39.2641,0,0,0,0,100,0),
(808490,32,-9801.14,-854.226,39.2437,0,0,0,0,100,0),
(808490,33,-9800.73,-862.676,39.3773,0,0,0,0,100,0),
(808490,34,-9791.28,-865.231,39.4332,0,0,0,0,100,0),
(808490,35,-9781.58,-859.276,39.5556,0,0,0,0,100,0),
(808490,36,-9774.63,-854.605,39.6591,0,0,0,0,100,0),
(808490,37,-9765.7,-860.062,39.5044,0,0,0,0,100,0),
(808490,38,-9758.3,-865.551,39.489,0,0,0,0,100,0),
(808490,39,-9756.08,-873.282,39.5315,0,0,0,0,100,0),
(808490,40,-9753.84,-880.89,39.5323,0,0,0,0,100,0),
(808490,41,-9758.36,-886.679,39.4433,0,0,0,0,100,0),
(808490,42,-9764.61,-886.983,39.4624,0,0,0,0,100,0);

--
-- END UPDATING QUERIES
--
COMMIT;
END //
DELIMITER ;
CALL updateDb();
DROP PROCEDURE IF EXISTS `updateDb`;
