-- DB update 2020_07_22_04 -> 2020_07_23_00
DROP PROCEDURE IF EXISTS `updateDb`;
DELIMITER //
CREATE PROCEDURE updateDb ()
proc:BEGIN DECLARE OK VARCHAR(100) DEFAULT 'FALSE';
SELECT COUNT(*) INTO @COLEXISTS
FROM information_schema.COLUMNS
WHERE TABLE_SCHEMA = DATABASE() AND TABLE_NAME = 'version_db_sol_world' AND COLUMN_NAME = '2020_07_22_04';
IF @COLEXISTS = 0 THEN LEAVE proc; END IF;
START TRANSACTION;
ALTER TABLE version_db_sol_world CHANGE COLUMN 2020_07_22_04 2020_07_23_00 bit;
SELECT sql_rev INTO OK FROM version_db_sol_world WHERE sql_rev = '1595539036329929983'; IF OK <> 'FALSE' THEN LEAVE proc; END IF;
--
-- START UPDATING QUERIES
--

INSERT INTO `version_db_sol_world` (`sql_rev`) VALUES ('1595539036329929983');

UPDATE `creature_template` SET `InhabitType` = `InhabitType` | 4 WHERE `entry` IN (29777,29780,29781,29782,29783,29784,29785,29802,29807,29812);
UPDATE `creature_template` SET `unit_flags` = `unit_flags` & ~512 WHERE `entry` = 29802;
UPDATE `creature_template` SET `unit_flags` = `unit_flags` & ~262144 WHERE `entry` = 29812;
UPDATE `creature` SET `wander_distance` = 0, `MovementType` = 0 WHERE `guid` IN (106190,106811);
UPDATE `creature` SET `MovementType` = 2 WHERE `guid` = 105492;
UPDATE `creature_addon` SET `path_id` = 1054920 WHERE `guid` = 105492;

UPDATE `creature_template` SET `AIName` = 'SmartAI' WHERE `entry` IN (29777,29780,29781,29782,29783,29784,29785,29802,29807,29812);
DELETE FROM `smart_scripts` WHERE `entryorguid` IN (29777,29780,29781,29782,29783,29784,29785,29802,29807,29812) AND `source_type` = 0;
INSERT INTO `smart_scripts` (`entryorguid`, `source_type`, `id`, `link`, `event_type`, `event_phase_mask`, `event_chance`, `event_flags`, `event_param1`, `event_param2`, `event_param3`, `event_param4`, `event_param5`, `action_type`, `action_param1`, `action_param2`, `action_param3`, `action_param4`, `action_param5`, `action_param6`, `target_type`, `target_param1`, `target_param2`, `target_param3`, `target_param4`, `target_x`, `target_y`, `target_z`, `target_o`, `comment`)
VALUES
(29777,0,0,0,11,0,100,0,0,0,0,0,0,60,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,'Cosmetic Mechanical Gorilla - On Respawn - Set Fly On Disable Gravity'),

(29780,0,0,0,11,0,100,0,0,0,0,0,0,60,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,'Cosmetic Mechanical Chicken - On Respawn - Set Fly On Disable Gravity'),

(29781,0,0,0,11,0,100,0,0,0,0,0,0,60,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,'Cosmetic Mechanical Squirrel - On Respawn - Set Fly On Disable Gravity'),

(29782,0,0,0,11,0,100,0,0,0,0,0,0,60,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,'Cosmetic Mechanical Sheep - On Respawn - Set Fly On Disable Gravity'),

(29783,0,0,0,11,0,100,0,0,0,0,0,0,60,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,'Cosmetic Clockwork Robot - On Respawn - Set Fly On Disable Gravity'),

(29784,0,0,0,11,0,100,0,0,0,0,0,0,60,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,'Cosmetic Clockwork Robot (Blue) - On Respawn - Set Fly On Disable Gravity'),

(29785,0,0,0,11,0,100,0,0,0,0,0,0,60,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,'Cosmetic Clockwork Robot (Red) - On Respawn - Set Fly On Disable Gravity'),

(29802,0,0,0,11,0,100,0,0,0,0,0,0,60,1,35,1,0,0,0,1,0,0,0,0,0,0,0,0,'Cosmetic Toy Plane - On Respawn - Set Fly On Disable Gravity'),

(29807,0,0,0,11,0,100,0,0,0,0,0,0,60,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,'[DND] Dalaran Toy Store Plane String Hook - On Respawn - Set Fly On Disable Gravity'),

(29812,0,0,0,11,0,100,0,0,0,0,0,0,60,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,'[DND] Dalaran Toy Store Plane String Bunny - On Respawn - Set Fly On Disable Gravity'),
(29812,0,1,0,1,0,100,1,500,500,0,0,0,11,55281,0,0,0,0,0,11,29802,20,0,0,0,0,0,0,'[DND] Dalaran Toy Store Plane String Bunny - OOC - Cast ''Toy Plane Cable'' (No Repeat)');

DELETE FROM `waypoint_data` WHERE `id` = 1054920;
INSERT INTO `waypoint_data` (`id`, `point`, `position_x`, `position_y`, `position_z`, `orientation`, `delay`, `move_type`, `action`, `action_chance`, `wpguid`)
VALUES
(1054920,1,5810.220,683.338,653.682,0,0,2,0,100,0),
(1054920,2,5810.569,683.083,653.682,0,0,2,0,100,0),
(1054920,3,5810.942,682.863,653.682,0,0,2,0,100,0),
(1054920,4,5811.335,682.682,653.682,0,0,2,0,100,0),
(1054920,5,5811.743,682.539,653.682,0,0,2,0,100,0),
(1054920,6,5812.163,682.437,653.682,0,0,2,0,100,0),
(1054920,7,5812.592,682.377,653.682,0,0,2,0,100,0),
(1054920,8,5813.024,682.359,653.682,0,0,2,0,100,0),
(1054920,9,5813.456,682.384,653.682,0,0,2,0,100,0),
(1054920,10,5813.883,682.450,653.682,0,0,2,0,100,0),
(1054920,11,5814.302,682.559,653.682,0,0,2,0,100,0),
(1054920,12,5814.708,682.708,653.682,0,0,2,0,100,0),
(1054920,13,5815.098,682.896,653.682,0,0,2,0,100,0),
(1054920,14,5815.467,683.121,653.682,0,0,2,0,100,0),
(1054920,15,5815.813,683.381,653.682,0,0,2,0,100,0),
(1054920,16,5816.131,683.674,653.682,0,0,2,0,100,0),
(1054920,17,5816.419,683.997,653.682,0,0,2,0,100,0),
(1054920,18,5816.674,684.346,653.682,0,0,2,0,100,0),
(1054920,19,5816.894,684.719,653.682,0,0,2,0,100,0),
(1054920,20,5817.075,685.112,653.682,0,0,2,0,100,0),
(1054920,21,5817.218,685.520,653.682,0,0,2,0,100,0),
(1054920,22,5817.320,685.940,653.682,0,0,2,0,100,0),
(1054920,23,5817.380,686.369,653.682,0,0,2,0,100,0),
(1054920,24,5817.398,686.801,653.682,0,0,2,0,100,0),
(1054920,25,5817.373,687.233,653.682,0,0,2,0,100,0),
(1054920,26,5817.307,687.660,653.682,0,0,2,0,100,0),
(1054920,27,5817.198,688.079,653.682,0,0,2,0,100,0),
(1054920,28,5817.049,688.485,653.682,0,0,2,0,100,0),
(1054920,29,5816.861,688.875,653.682,0,0,2,0,100,0),
(1054920,30,5816.636,689.244,653.682,0,0,2,0,100,0),
(1054920,31,5816.376,689.590,653.682,0,0,2,0,100,0),
(1054920,32,5816.083,689.908,653.682,0,0,2,0,100,0),
(1054920,33,5815.760,690.196,653.682,0,0,2,0,100,0),
(1054920,34,5815.411,690.451,653.682,0,0,2,0,100,0),
(1054920,35,5815.038,690.671,653.682,0,0,2,0,100,0),
(1054920,36,5814.645,690.852,653.682,0,0,2,0,100,0),
(1054920,37,5814.237,690.995,653.682,0,0,2,0,100,0),
(1054920,38,5813.817,691.097,653.682,0,0,2,0,100,0),
(1054920,39,5813.388,691.157,653.682,0,0,2,0,100,0),
(1054920,40,5812.956,691.175,653.682,0,0,2,0,100,0),
(1054920,41,5812.524,691.150,653.682,0,0,2,0,100,0),
(1054920,42,5812.097,691.084,653.682,0,0,2,0,100,0),
(1054920,43,5811.678,690.975,653.682,0,0,2,0,100,0),
(1054920,44,5811.272,690.826,653.682,0,0,2,0,100,0),
(1054920,45,5810.882,690.638,653.682,0,0,2,0,100,0),
(1054920,46,5810.513,690.413,653.682,0,0,2,0,100,0),
(1054920,47,5810.167,690.153,653.682,0,0,2,0,100,0),
(1054920,48,5809.849,689.860,653.682,0,0,2,0,100,0),
(1054920,49,5809.561,689.537,653.682,0,0,2,0,100,0),
(1054920,50,5809.306,689.188,653.682,0,0,2,0,100,0),
(1054920,51,5809.086,688.815,653.682,0,0,2,0,100,0),
(1054920,52,5808.905,688.422,653.682,0,0,2,0,100,0),
(1054920,53,5808.762,688.014,653.682,0,0,2,0,100,0),
(1054920,54,5808.660,687.594,653.682,0,0,2,0,100,0),
(1054920,55,5808.600,687.165,653.682,0,0,2,0,100,0),
(1054920,56,5808.582,686.733,653.682,0,0,2,0,100,0),
(1054920,57,5808.607,686.301,653.682,0,0,2,0,100,0),
(1054920,58,5808.673,685.874,653.682,0,0,2,0,100,0),
(1054920,59,5808.782,685.455,653.682,0,0,2,0,100,0),
(1054920,60,5808.931,685.049,653.682,0,0,2,0,100,0),
(1054920,61,5809.119,684.659,653.682,0,0,2,0,100,0),
(1054920,62,5809.344,684.290,653.682,0,0,2,0,100,0),
(1054920,63,5809.604,683.944,653.682,0,0,2,0,100,0),
(1054920,64,5809.897,683.626,653.682,0,0,2,0,100,0);

--
-- END UPDATING QUERIES
--
COMMIT;
END //
DELIMITER ;
CALL updateDb();
DROP PROCEDURE IF EXISTS `updateDb`;
