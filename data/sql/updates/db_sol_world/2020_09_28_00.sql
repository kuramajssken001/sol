-- DB update 2020_09_27_01 -> 2020_09_28_00
DROP PROCEDURE IF EXISTS `updateDb`;
DELIMITER //
CREATE PROCEDURE updateDb ()
proc:BEGIN DECLARE OK VARCHAR(100) DEFAULT 'FALSE';
SELECT COUNT(*) INTO @COLEXISTS
FROM information_schema.COLUMNS
WHERE TABLE_SCHEMA = DATABASE() AND TABLE_NAME = 'version_db_sol_world' AND COLUMN_NAME = '2020_09_27_01';
IF @COLEXISTS = 0 THEN LEAVE proc; END IF;
START TRANSACTION;
ALTER TABLE version_db_sol_world CHANGE COLUMN 2020_09_27_01 2020_09_28_00 bit;
SELECT sql_rev INTO OK FROM version_db_sol_world WHERE sql_rev = '1601297683002717969'; IF OK <> 'FALSE' THEN LEAVE proc; END IF;
--
-- START UPDATING QUERIES
--

INSERT INTO `version_db_sol_world` (`sql_rev`) VALUES ('1601297683002717969');

DELETE FROM `creature_formations` WHERE `leaderGUID` IN (15424,116284,80849,2283,3254,3476,84028,90439,89294,45501,79720,90481,13990,13178,57594,14049,14048,14010,14034,14042,14018,14032,114764,6885,15144,51815,14056,9203,92287,21698,7209);
INSERT INTO `creature_formations` (`leaderGUID`, `memberGUID`, `dist`, `angle`, `groupAI`)
VALUES
-- Zixil
(15424,15423,3,0,2),
(15424,15424,0,0,2),
-- Conquest Hold Legionnaire
(116284,116284,0,0,2),
(116284,116285,3,90,2),
-- Princess
(80849,80849,0,0,2),
(80849,80850,2,315,2),
(80849,80848,2,45,2),
-- Ironforge Mountaineer
(2283,2283,0,0,2),
(2283,2284,2,270,2),
-- Raider Jhash
(3254,3254,0,0,2),
(3254,3256,3,90,2),
-- Xan'tish
(3476,3476,0,0,2),
(3476,3477,3,315,0),
(3476,3560,3,0,0),
(3476,3571,3,45,0),
-- Miss Danna
(84028,84028,0,0,0),
(84028,87092,2,30,0),
(84028,87088,2,60,0),
(84028,87090,2,90,0),
(84028,87089,2,330,0),
(84028,87082,2,300,0),
(84028,87091,2,270,0),
(84028,87023,2,120,0),
-- Karlee Chaddis
(90439,90439,0,0,0),
(90439,90440,1.5,270,0),
(90439,90443,2,0,0),
-- Suzanne
(89294,89294,0,0,0),
(89294,86596,3,330,0),
(89294,86597,3,30,0),
-- Lil Timmy
(45501,45501,0,0,0),
(45501,23427,2,0,0),
-- William
(79720,79720,0,0,0),
(79720,79721,4,0,0),
-- Kimberly Grant
(90481,90481,0,0,0),
(90481,90482,2,90,0),
-- Hezrul Bloodmark
(13990,13990,0,0,2),
(13990,13991,2,270,2),
(13990,13992,3,0,2),
-- Trok
(13178,13178,0,0,0),
(13178,13589,3.1,345,0),
(13178,13588,2.2,355,0),
(13178,13587,2.4,5,0),
(13178,13586,2.7,15,0),
-- Thrallmar Wolf Rider
(57594,57594,0,0,2),
(57594,57595,5,180,2),
(57594,57596,10,180,2),
(57594,57597,5,0,2),
-- Gazelle group 1
(14049,14049,0,0,0),
(14049,14050,3.9,220,0),
(14049,14051,6.8,234,0),
(14049,14052,4.5,140,0),
(14049,14053,4.6,89,0),
(14049,14054,3.0,304,0),
-- Gazelle group 2
(14048,14048,0,0,0),
(14048,14027,4.3,352,0),
(14048,14028,2.7,173,0),
(14048,14029,5.9,148,0),
(14048,14030,5.0,254,0),
(14048,14031,2.9,226,0),
-- Gazelle group 3
(14010,14010,0,0,0),
(14010,14011,6.6,148,0),
(14010,14012,6.6,330,0),
(14010,14013,5.2,250,0),
(14010,14014,3.6,215,0),
(14010,14015,6.8,317,0),
(14010,14016,6.1,98,0),
(14010,14017,3.3,346,0),
-- Gazelle group 4
(14034,14034,0,0,0),
(14034,14035,3.5,50,0),
(14034,14036,2.3,97,0),
(14034,14037,5.1,164,0),
(14034,14038,6.8,75,0),
(14034,14039,6.5,133,0),
(14034,14040,4.4,108,0),
(14034,14041,6.0,316,0),
-- Gazelle group 5
(14042,14042,0,0,0),
(14042,14043,3.7,197,0),
(14042,14044,2.0,302,0),
(14042,14045,6.4,347,0),
(14042,14046,6.4,276,0),
(14042,14047,4.7,44,0),
-- Gazelle group 6
(14018,14018,0,0,0),
(14018,14019,3.2,327,0),
(14018,14020,2.9,103,0),
(14018,14021,3.5,177,0),
(14018,14022,2.3,264,0),
-- Gazelle group 7
(14032,14032,0,0,0),
(14032,14009,2.9,276,0),
(14032,14023,3.6,351,0),
(14032,14024,2.2,27,0),
(14032,14025,5.9,318,0),
(14032,14026,2.2,128,0),
-- Warp-Huntress Kula
(114764,114764,0,0,2),
(114764,2023271,2,20,2),
-- Thal'trak Proudtusk
(6885,6877,12,0,2),
(6885,6880,9,0,2),
(6885,6883,6,0,2),
(6885,6885,0,0,2),
(6885,6886,3,0,2),
-- Wooly Kodo
(15144,15135,15,0,2),
(15144,15141,9,240,2),
(15144,15142,12,90,2),
(15144,15144,0,0,2),
-- Brontus
(51815,51815,0,0,2),
(51815,15137,15,340,2),
(51815,15138,12,90,2),
(51815,15139,15,20,2),
(51815,15140,9,240,2),
-- Lizzarik
(14056,14056,0,0,2),
(14056,14057,3,90,2),
-- Haren Swifthoof
(9203,9204,3,0,2),
(9203,9205,3,270,2),
(9203,9203,0,0,2),
-- Crimson Courier
(92287,92291,3,180,2),
(92287,92290,3,0,2),
(92287,92288,3,270,2),
(92287,92289,3,90,2),
(92287,92287,0,0,2),
-- Steelsnap
(21698,21660,3,270,2),
(21698,21661,5,0,2),
(21698,21698,0,0,2),
-- Boss Tho'grun
(7209,6973,5,70,2),
(7209,6974,5,130,2),
(7209,6975,5,230,2),
(7209,6989,5,290,2),
(7209,7210,5,330,2),
(7209,7209,0,0,2);

--
-- END UPDATING QUERIES
--
COMMIT;
END //
DELIMITER ;
CALL updateDb();
DROP PROCEDURE IF EXISTS `updateDb`;
