-- DB update 2022_01_26_02 -> 2022_01_26_03
DROP PROCEDURE IF EXISTS `updateDb`;
DELIMITER //
CREATE PROCEDURE updateDb ()
proc:BEGIN DECLARE OK VARCHAR(100) DEFAULT 'FALSE';
SELECT COUNT(*) INTO @COLEXISTS
FROM information_schema.COLUMNS
WHERE TABLE_SCHEMA = DATABASE() AND TABLE_NAME = 'version_db_sol_world' AND COLUMN_NAME = '2022_01_26_02';
IF @COLEXISTS = 0 THEN LEAVE proc; END IF;
START TRANSACTION;
ALTER TABLE version_db_sol_world CHANGE COLUMN 2022_01_26_02 2022_01_26_03 bit;
SELECT sql_rev INTO OK FROM version_db_sol_world WHERE sql_rev = '1643210673466570664'; IF OK <> 'FALSE' THEN LEAVE proc; END IF;
--
-- START UPDATING QUERIES
--

INSERT INTO `version_db_sol_world` (`sql_rev`) VALUES ('1643210673466570664');

UPDATE `creature_template` SET `unit_flags` = 33555200, `InhabitType` = 4 WHERE `entry` = 10716;

DELETE FROM `creature` WHERE `guid` BETWEEN 3008931 AND 3008942;
INSERT INTO `creature` (`guid`, `id`, `map`, `zoneId`, `areaId`, `spawnMask`, `phaseMask`, `equipment_id`, `position_x`, `position_y`, `position_z`, `orientation`, `spawntimesecs`, `wander_distance`, `curhealth`, `curmana`, `MovementType`, `npcflag`, `unit_flags`, `dynamicflags`, `VerifiedBuild`)
VALUES
(3008931,10716,0,0,0,1,1,0,2291.84,292.171,81.5713,2.86234,-1,0,1,0,2,0,0,0,0),
(3008932,10716,0,0,0,1,1,0,2290.52,287.5,81.4823,2.72271,-1,0,1,0,2,0,0,0,0),
(3008933,10716,0,0,0,1,1,0,2293.2,296.473,81.7742,2.75762,-1,0,1,0,2,0,0,0,0),
(3008934,10716,0,0,0,1,1,0,2295.22,281.972,81.7218,3.97935,-1,0,1,0,2,0,0,0,0),
(3008935,10716,0,0,0,1,1,0,2299.58,280.706,81.6103,4.29351,-1,0,1,0,2,0,0,0,0),
(3008936,10716,0,0,0,1,1,0,2303.57,279.754,81.6749,4.74729,-1,0,1,0,2,0,0,0,0),
(3008937,10716,0,0,0,1,1,0,2309.1,282.281,81.0983,6.05629,-1,0,1,0,2,0,0,0,0),
(3008938,10716,0,0,0,1,1,0,2309.64,287.967,81.852,5.91667,-1,0,1,0,2,0,0,0,0),
(3008939,10716,0,0,0,1,1,0,2311.46,292.325,81.2885,0.383972,-1,0,1,0,2,0,0,0,0),
(3008940,10716,0,0,0,1,1,0,2308.97,297.232,81.7615,1.22173,-1,0,1,0,2,0,0,0,0),
(3008941,10716,0,0,0,1,1,0,2303.29,298.127,82.2253,1.22173,-1,0,1,0,2,0,0,0,0),
(3008942,10716,0,0,0,1,1,0,2298.5,299.817,81.8604,0.977384,-1,0,1,0,2,0,0,0,0);

DELETE FROM `creature_addon` WHERE `guid` BETWEEN 3008931 AND 3008942;
INSERT INTO `creature_addon` (`guid`, `path_id`, `mount`, `bytes1`, `bytes2`, `emote`, `isLarge`, `auras`)
VALUES
(3008931,30089310,0,0,0,0,0,NULL),
(3008932,30089320,0,0,0,0,0,NULL),
(3008933,30089330,0,0,0,0,0,NULL),
(3008934,30089340,0,0,0,0,0,NULL),
(3008935,30089350,0,0,0,0,0,NULL),
(3008936,30089360,0,0,0,0,0,NULL),
(3008937,30089370,0,0,0,0,0,NULL),
(3008938,30089380,0,0,0,0,0,NULL),
(3008939,30089390,0,0,0,0,0,NULL),
(3008940,30089400,0,0,0,0,0,NULL),
(3008941,30089410,0,0,0,0,0,NULL),
(3008942,30089420,0,0,0,0,0,NULL);

UPDATE `creature_template` SET `AIName` = 'SmartAI' WHERE `entry` = 10716;
UPDATE `smart_scripts` SET `link` = 28 WHERE `source_type` = 1 AND `entryorguid` = -45022 AND `id` = 3;
DELETE FROM `smart_scripts` WHERE `source_type` = 1 AND `entryorguid` = -45022 AND `id` = 28;
DELETE FROM `smart_scripts` WHERE `source_type` = 0 AND `entryorguid` = 10716;
INSERT INTO `smart_scripts` (`entryorguid`, `source_type`, `id`, `link`, `event_type`, `event_phase_mask`, `event_chance`, `event_flags`, `event_param1`, `event_param2`, `event_param3`, `event_param4`, `event_param5`, `action_type`, `action_param1`, `action_param2`, `action_param3`, `action_param4`, `action_param5`, `action_param6`, `target_type`, `target_param1`, `target_param2`, `target_param3`, `target_param4`, `target_x`, `target_y`, `target_z`, `target_o`, `comment`)
VALUES
(-45022,1,28,0,61,0,100,0,0,0,0,0,0,70,0,0,0,0,0,0,11,10716,50,2,0,0,0,0,0,'Horde Bell - Linked - Respawn Creature (Belfry Bat)'),

(10716,0,0,1,11,0,100,0,0,0,0,0,0,48,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,'Belfry Bat - On Respawn - Set Active On'),
(10716,0,1,0,61,0,100,0,0,0,0,0,0,41,60000,0,0,0,0,0,1,0,0,0,0,0,0,0,0,'Belfry Bat - Linked - Force Despawn');

DELETE FROM `waypoint_scripts` WHERE `id` = 849301;
INSERT INTO `waypoint_scripts` (`id`, `delay`, `command`, `datalong`, `datalong2`, `dataint`, `x`, `y`, `z`, `o`, `guid`)
VALUES
(849301,0,16,6596,2,0,0,0,0,0,201194);

DELETE FROM `waypoint_data` WHERE `id` IN (30089310,30089320,30089330,30089340,30089350,30089360,30089370,30089380,30089390,30089400,30089410,30089420);
INSERT INTO `waypoint_data` (`id`, `point`, `position_x`, `position_y`, `position_z`, `orientation`, `delay`, `move_type`, `action`, `action_chance`, `wpguid`)
VALUES
(30089310,1,2291.84,292.171,81.5713,0,0,1,849301,100,0),
(30089310,2,2264.93,300.33,76.0303,0,0,1,0,100,0),
(30089310,3,2245.7,321.633,59.5581,0,0,1,0,100,0),
(30089310,4,2227.82,320.307,60.3246,0,0,1,0,100,0),
(30089310,5,2208.38,340.749,60.3246,0,0,1,0,100,0),
(30089310,6,2184.14,372.24,60.3246,0,0,1,0,100,0),
(30089310,7,2180.27,386.8,60.3246,0,0,1,0,100,0),
(30089310,8,2163.42,392.268,60.3246,0,0,1,0,100,0),
(30089310,9,2119.56,369.353,60.3246,0,0,1,0,100,0),
(30089310,10,2096.48,331.222,69.3246,0,0,1,0,100,0),
(30089310,11,2081.8,305.435,80.0746,0,0,1,0,100,0),
(30089310,12,2062.15,278.32,75.2413,0,0,1,0,100,0),
(30089310,13,2058.27,272.926,68.7413,2.93044,60000,1,0,100,0),

(30089320,1,2290.52,287.5,81.4823,0,0,1,0,100,0),
(30089320,2,2266.4,299.696,76.5045,0,0,1,0,100,0),
(30089320,3,2249.47,319.335,66.5045,0,0,1,0,100,0),
(30089320,4,2225.67,327.811,58.3656,0,0,1,0,100,0),
(30089320,5,2212.79,354.636,58.3656,0,0,1,0,100,0),
(30089320,6,2188.07,387.682,58.3656,0,0,1,0,100,0),
(30089320,7,2152.82,398.835,58.3656,0,0,1,0,100,0),
(30089320,8,2108.86,381.305,58.3656,0,0,1,0,100,0),
(30089320,9,2094.75,337.62,67.1712,0,0,1,0,100,0),
(30089320,10,2085.13,303.132,80.5879,0,0,1,849301,100,0),
(30089320,11,2064.19,284.048,78.8582,0,0,1,0,100,0),
(30089320,12,2058.66,276.401,68.5526,2.93044,60000,1,0,100,0),

(30089330,1,2293.2,296.473,81.7742,0,0,1,0,100,0),
(30089330,2,2266.49,305.486,75.8082,0,0,1,0,100,0),
(30089330,3,2255.95,330.839,63.0582,0,0,1,0,100,0),
(30089330,4,2226.15,362.274,47.7526,0,0,1,0,100,0),
(30089330,5,2196.44,396.826,55.3498,0,0,1,0,100,0),
(30089330,6,2166.13,402.358,72.0024,0,0,1,0,100,0),
(30089330,7,2135.91,391.732,72.0024,0,0,1,0,100,0),
(30089330,8,2111.65,352.752,76.3358,0,0,1,0,100,0),
(30089330,9,2094.03,313.951,82.5024,0,0,1,0,100,0),
(30089330,10,2086.23,297.227,79.2802,0,0,1,0,100,0),
(30089330,11,2061.23,304.009,79.2802,0,0,1,0,100,0),
(30089330,12,2059,280.492,68.0858,2.93044,60000,1,0,100,0),

(30089340,1,2295.22,281.972,81.7218,0,0,1,0,100,0),
(30089340,2,2271.7,260.51,79.6346,0,0,1,0,100,0),
(30089340,3,2245.73,241.697,71.9957,0,0,1,0,100,0),
(30089340,4,2199.07,250.287,61.0791,0,0,1,0,100,0),
(30089340,5,2165.34,277.854,85.1068,0,0,1,0,100,0),
(30089340,6,2157.69,323.028,71.9957,0,0,1,0,100,0),
(30089340,7,2129.3,359.357,71.9957,0,0,1,0,100,0),
(30089340,8,2112.34,354.093,71.9957,0,0,1,0,100,0),
(30089340,9,2099.34,318.189,77.3846,0,0,1,0,100,0),
(30089340,10,2055.8,296.967,79.2761,0,0,1,0,100,0),
(30089340,11,2060.52,284.788,68.4983,2.93044,60000,1,0,100,0),

(30089350,1,2299.58,280.706,81.6103,0,0,1,0,100,0),
(30089350,2,2285.69,255.447,78.6529,0,0,1,0,100,0),
(30089350,3,2263.81,220.705,50.0695,0,0,1,0,100,0),
(30089350,4,2240.59,205.898,41.4028,0,0,1,0,100,0),
(30089350,5,2203.68,208.694,50.3151,0,0,1,0,100,0),
(30089350,6,2184.36,226.691,43.8706,0,0,1,849301,100,0),
(30089350,7,2176.79,270.21,49.704,0,0,1,0,100,0),
(30089350,8,2163.31,304.421,69.681,0,0,1,0,100,0),
(30089350,9,2148.45,319.839,69.681,0,0,1,0,100,0),
(30089350,10,2125.1,328.728,69.681,0,0,1,0,100,0),
(30089350,11,2114.31,318.784,74.2644,0,0,1,0,100,0),
(30089350,12,2092.64,301.254,78.4033,0,0,1,0,100,0),
(30089350,13,2059.01,299.46,79.2092,0,0,1,0,100,0),
(30089350,14,2061.62,288.809,68.4314,2.93044,60000,1,0,100,0),

(30089360,1,2303.57,279.754,81.6749,0,0,1,0,100,0),
(30089360,2,2311.11,239.684,76.9786,0,0,1,0,100,0),
(30089360,3,2292.06,209.532,51.8397,0,0,1,0,100,0),
(30089360,4,2257.2,197.624,39.3119,0,0,1,0,100,0),
(30089360,5,2216.39,194.894,48.7513,0,0,1,0,100,0),
(30089360,6,2199.18,184.032,54.0052,0,0,1,0,100,0),
(30089360,7,2191.93,184.959,54.0052,0,0,1,0,100,0),
(30089360,8,2184.52,193.207,54.0052,0,0,1,0,100,0),
(30089360,9,2162.16,233.374,54.0052,0,0,1,0,100,0),
(30089360,10,2159.82,282.662,63.8107,0,0,1,0,100,0),
(30089360,11,2134.77,300.58,79.8663,0,0,1,0,100,0),
(30089360,12,2110.28,296.656,79.7553,0,0,1,0,100,0),
(30089360,13,2083.85,304.948,79.5608,0,0,1,0,100,0),
(30089360,14,2063.93,307.476,79.5608,0,0,1,0,100,0),
(30089360,15,2063.41,290.585,70.6718,2.93044,60000,1,0,100,0),

(30089370,1,2309.1,282.281,81.0983,0,0,1,0,100,0),
(30089370,2,2338.2,263.054,76.5369,0,0,1,0,100,0),
(30089370,3,2344.89,261.101,66.3424,0,0,1,0,100,0),
(30089370,4,2361.71,242.326,52.6757,0,0,1,0,100,0),
(30089370,5,2349.91,220.967,47.8702,0,0,1,0,100,0),
(30089370,6,2323.97,238.057,45.0646,0,0,1,0,100,0),
(30089370,7,2290.47,258.102,43.0924,0,0,1,0,100,0),
(30089370,8,2247.54,281.933,43.0924,0,0,1,0,100,0),
(30089370,9,2212.92,296.895,45.648,0,0,1,0,100,0),
(30089370,10,2181.48,318.591,46.898,0,0,1,849301,100,0),
(30089370,11,2144.87,327.883,71.9224,0,0,1,0,100,0),
(30089370,12,2110.18,313.438,88.1725,0,0,1,0,100,0),
(30089370,13,2101.52,321.703,79.0907,0,0,1,0,100,0),
(30089370,14,2071.03,289.043,70.7296,6.06025,60000,1,0,100,0),

(30089380,1,2309.64,287.967,81.852,0,0,1,0,100,0),
(30089380,2,2335.42,270.261,79.4475,0,0,1,0,100,0),
(30089380,3,2342.52,265.395,79.4475,0,0,1,0,100,0),
(30089380,4,2341.58,253.927,79.4475,0,0,1,0,100,0),
(30089380,5,2324.81,240.491,79.4475,0,0,1,0,100,0),
(30089380,6,2297.62,255.064,79.4475,0,0,1,0,100,0),
(30089380,7,2268.71,283.138,62.2808,0,0,1,0,100,0),
(30089380,8,2252.81,312.339,49.8641,0,0,1,0,100,0),
(30089380,9,2242.41,346.75,43.1419,0,0,1,0,100,0),
(30089380,10,2206.45,368.546,45.6141,0,0,1,0,100,0),
(30089380,11,2166.88,368.07,71.6564,0,0,1,0,100,0),
(30089380,12,2125.27,340.611,76.9897,0,0,1,0,100,0),
(30089380,13,2103.6,308.622,80.0175,0,0,1,0,100,0),
(30089380,14,2085.14,299.304,79.3508,0,0,1,0,100,0),
(30089380,15,2073.13,286.396,68.6286,6.06025,60000,1,0,100,0),

(30089390,1,2311.46,292.325,81.2885,0,0,1,0,100,0),
(30089390,2,2341.2,315.339,92.9031,0,0,1,0,100,0),
(30089390,3,2346.01,334.989,92.9031,0,0,1,0,100,0),
(30089390,4,2332.45,368.038,64.153,0,0,1,0,100,0),
(30089390,5,2295.64,383.844,48.264,0,0,1,0,100,0),
(30089390,6,2263.88,364.485,44.7918,0,0,1,0,100,0),
(30089390,7,2244.02,354.555,41.9306,0,0,1,0,100,0),
(30089390,8,2227.37,352.994,41.9306,0,0,1,0,100,0),
(30089390,9,2219.44,372.144,49.6528,0,0,1,0,100,0),
(30089390,10,2178.17,360.458,63.5417,0,0,1,0,100,0),
(30089390,11,2142.39,329.195,78.5973,0,0,1,0,100,0),
(30089390,12,2103.12,304.904,80.9584,0,0,1,0,100,0),
(30089390,13,2102.17,281.625,79.6251,0,0,1,0,100,0),
(30089390,14,2087.82,280.267,72.4862,0,0,1,0,100,0),
(30089390,15,2073.35,281.459,68.4028,6.06025,60000,1,0,100,0),

(30089400,1,2308.97,297.232,81.7615,0,0,1,0,100,0),
(30089400,2,2317.39,324.37,87.6875,0,0,1,0,100,0),
(30089400,3,2319.51,352.401,98.1597,0,0,1,0,100,0),
(30089400,4,2314.95,369.938,89.2986,0,0,1,0,100,0),
(30089400,5,2298.73,382.324,78.243,0,0,1,0,100,0),
(30089400,6,2255.23,406.108,74.3263,0,0,1,0,100,0),
(30089400,7,2213.99,403.274,68.4097,0,0,1,0,100,0),
(30089400,8,2180.02,376.944,72.0208,0,0,1,0,100,0),
(30089400,9,2145.97,346.626,91.993,0,0,1,0,100,0),
(30089400,10,2106.56,315.518,93.6319,0,0,1,0,100,0),
(30089400,11,2088.44,276.4,79.493,0,0,1,0,100,0),
(30089400,12,2070.79,277.661,68.3819,6.06025,60000,1,0,100,0),

(30089410,1,2303.29,298.127,82.2253,0,0,1,0,100,0),
(30089410,2,2320.83,333.567,84.6234,0,0,1,0,100,0),
(30089410,3,2337.03,353.59,84.6234,0,0,1,0,100,0),
(30089410,4,2342.09,369.61,70.4845,0,0,1,0,100,0),
(30089410,5,2318,392.368,60.0678,0,0,1,0,100,0),
(30089410,6,2288.77,379.469,44.8456,0,0,1,0,100,0),
(30089410,7,2275.84,340.661,41.7067,0,0,1,0,100,0),
(30089410,8,2259.18,303.696,40.3734,0,0,1,0,100,0),
(30089410,9,2235.24,273.893,47.3178,0,0,1,0,100,0),
(30089410,10,2202.87,260.562,59.8733,0,0,1,0,100,0),
(30089410,11,2160.82,255.893,84.6234,0,0,1,0,100,0),
(30089410,12,2128.03,276.408,78.5123,0,0,1,0,100,0),
(30089410,13,2138.47,298.958,84.6234,0,0,1,0,100,0),
(30089410,14,2128.32,327.652,101.651,0,0,1,0,100,0),
(30089410,15,2114.16,327.721,98.5679,0,0,1,0,100,0),
(30089410,16,2101.72,303.272,90.0401,0,0,1,0,100,0),
(30089410,17,2079.03,302.569,79.4567,0,0,1,849301,100,0),
(30089410,18,2070.14,274.324,68.4845,6.06025,60000,1,0,100,0),

(30089420,1,2298.5,299.817,81.8604,0,0,1,0,100,0),
(30089420,2,2318.8,334.149,78.1706,0,0,1,0,100,0),
(30089420,3,2342.19,358.182,78.1706,0,0,1,0,100,0),
(30089420,4,2343.44,401.081,87.6151,0,0,1,0,100,0),
(30089420,5,2322.85,445.486,78.1706,0,0,1,0,100,0),
(30089420,6,2296.31,453.007,72.2817,0,0,1,0,100,0),
(30089420,7,2266.73,428.025,60.3095,0,0,1,0,100,0),
(30089420,8,2232.3,413.587,73.7262,0,0,1,0,100,0),
(30089420,9,2188.09,402.132,86.9762,0,0,1,0,100,0),
(30089420,10,2141.08,394.649,71.7261,0,0,1,0,100,0),
(30089420,11,2118.99,353.406,78.1706,0,0,1,0,100,0),
(30089420,12,2107.4,322.727,87.3928,0,0,1,0,100,0),
(30089420,13,2083.29,311.605,81.7539,0,0,1,0,100,0),
(30089420,14,2065.27,304.688,75.2817,0,0,1,0,100,0),
(30089420,15,2062.12,283.634,75.2817,0,0,1,0,100,0),
(30089420,16,2069.19,269.863,68.9761,6.06025,60000,1,0,100,0);

--
-- END UPDATING QUERIES
--
COMMIT;
END //
DELIMITER ;
CALL updateDb();
DROP PROCEDURE IF EXISTS `updateDb`;
