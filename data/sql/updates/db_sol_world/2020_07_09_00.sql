-- DB update 2020_07_08_01 -> 2020_07_09_00
DROP PROCEDURE IF EXISTS `updateDb`;
DELIMITER //
CREATE PROCEDURE updateDb ()
proc:BEGIN DECLARE OK VARCHAR(100) DEFAULT 'FALSE';
SELECT COUNT(*) INTO @COLEXISTS
FROM information_schema.COLUMNS
WHERE TABLE_SCHEMA = DATABASE() AND TABLE_NAME = 'version_db_sol_world' AND COLUMN_NAME = '2020_07_08_01';
IF @COLEXISTS = 0 THEN LEAVE proc; END IF;
START TRANSACTION;
ALTER TABLE version_db_sol_world CHANGE COLUMN 2020_07_08_01 2020_07_09_00 bit;
SELECT sql_rev INTO OK FROM version_db_sol_world WHERE sql_rev = '1594246623697504216'; IF OK <> 'FALSE' THEN LEAVE proc; END IF;
--
-- START UPDATING QUERIES
--

INSERT INTO `version_db_sol_world` (`sql_rev`) VALUES ('1594246623697504216');

-- Hezrul Bloodmark: Formation
DELETE FROM `creature_formations` WHERE `leaderGUID` = 13990;
INSERT INTO `creature_formations` (`leaderGUID`, `memberGUID`, `dist`, `angle`, `groupAI`)
VALUES
(13990,13990,0,0,2),
(13990,13991,2,90,2),
(13990,13992,3,180,2);

-- Hezrul Bloodmark: Set active
DELETE FROM `smart_scripts` WHERE `entryorguid` = 3396 AND `source_type` = 0 AND `id` = 1;
INSERT INTO `smart_scripts` (`entryorguid`, `source_type`, `id`, `link`, `event_type`, `event_phase_mask`, `event_chance`, `event_flags`, `event_param1`, `event_param2`, `event_param3`, `event_param4`, `event_param5`, `action_type`, `action_param1`, `action_param2`, `action_param3`, `action_param4`, `action_param5`, `action_param6`, `target_type`, `target_param1`, `target_param2`, `target_param3`, `target_param4`, `target_x`, `target_y`, `target_z`, `target_o`, `comment`)
VALUES
(3396,0,1,0,11,0,100,0,0,0,0,0,0,48,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,'Hezrul Bloodmark - On Respawn - Set Active On');

-- Some Kolkar NPCs: Relocation; enable random movement
UPDATE `creature` SET `MovementType` = 1, `wander_distance` = 5 WHERE `guid` IN (20856,20568,20571);
UPDATE `creature` SET `MovementType` = 1, `wander_distance` = 5, `position_x` = -1248.01, `position_y` = -2082.37, `position_z` = 90.9751 WHERE `guid` IN (20860,20577);

-- Hezrul Bloodmark: waypoint movement
UPDATE `creature` SET `MovementType` = 2 WHERE `guid` = 13990;
UPDATE `creature_addon` SET `path_id` = 139900 WHERE `guid` = 13990;
DELETE FROM `waypoint_data` WHERE `id` = 139900;
INSERT INTO `waypoint_data` (`id`, `point`, `position_x`, `position_y`, `position_z`, `orientation`, `delay`, `move_type`, `action`, `action_chance`, `wpguid`)
VALUES
(139900,1,-1167.06,-2042.27,92.1823,0,0,0,0,100,5011371),
(139900,2,-1157,-2031.75,92.4741,0,0,0,0,100,5011372),
(139900,3,-1140.67,-2023.37,91.5565,0,0,0,0,100,5011373),
(139900,4,-1128.87,-2013.8,90.6186,0,0,0,0,100,5011374),
(139900,5,-1119.15,-2006.35,88.5144,0,0,0,0,100,5011375),
(139900,6,-1109.53,-1999.69,86.7894,0,0,0,0,100,5011376),
(139900,7,-1098.06,-1992.05,87.0505,0,0,0,0,100,5011377),
(139900,8,-1088.41,-1984.69,87.5822,0,0,0,0,100,5011378),
(139900,9,-1078.25,-1974.3,88.8968,0,0,0,0,100,5011379),
(139900,10,-1067.25,-1963.03,89.3003,0,0,0,0,100,5011380),
(139900,11,-1059.54,-1955.43,90.453,0,0,0,0,100,5011381),
(139900,12,-1052.68,-1949.01,92.0409,0,0,0,0,100,5011382),
(139900,13,-1045.44,-1942.67,91.8032,0,0,0,0,100,5011383),
(139900,14,-1035.85,-1937.99,91.1389,0,0,0,0,100,5011384),
(139900,15,-1023.92,-1936.57,91.0423,0,0,0,0,100,5011385),
(139900,16,-1007.04,-1938.53,92.1023,0,0,0,0,100,5011386),
(139900,17,-993.676,-1939.34,93.4373,0,0,0,0,100,5011387),
(139900,18,-977.417,-1941.48,93.2161,0,0,0,0,100,5011388),
(139900,19,-961.801,-1945.31,93.05,0,0,0,0,100,5011389),
(139900,20,-946.824,-1948.98,92.2014,0,0,0,0,100,5011390),
(139900,21,-933.334,-1952.29,91.746,0,0,0,0,100,5011391),
(139900,22,-921.956,-1955.56,92.0949,0,0,0,0,100,5011392),
(139900,23,-907.601,-1961.72,92.8876,0,0,0,0,100,5011393),
(139900,24,-892.808,-1969.53,93.3179,0,0,0,0,100,5011394),
(139900,25,-879.908,-1977.36,93.5577,0,0,0,0,100,5011395),
(139900,26,-873.396,-1985.75,93.0582,0,0,0,0,100,5011396),
(139900,27,-870.685,-1996.65,91.1128,0,0,0,0,100,5011397),
(139900,28,-872.433,-2008.98,88.3537,0,0,0,0,100,5011398),
(139900,29,-875.127,-2021.27,84.5014,0,0,0,0,100,5011399),
(139900,30,-877.911,-2034.43,81.7036,0,0,0,0,100,5011400),
(139900,31,-878.57,-2045.43,81.0985,0,0,0,0,100,5011401),
(139900,32,-878.53,-2058.34,81.5962,0,0,0,0,100,5011402),
(139900,33,-878.741,-2071.36,84.096,0,0,0,0,100,5011403),
(139900,34,-878.228,-2085.46,87.873,0,0,0,0,100,5011404),
(139900,35,-879.914,-2099.34,90.5967,0,0,0,0,100,5011405),
(139900,36,-883.381,-2111.98,92.3217,0,0,0,0,100,5011406),
(139900,37,-888.329,-2126.98,93.9785,0,0,0,0,100,5011407),
(139900,38,-890.304,-2138.06,95.2488,0,0,0,0,100,5011408),
(139900,39,-891.468,-2145.3,93.3258,0,0,0,0,100,5011409),
(139900,40,-892.545,-2157.5,92.983,0,0,0,0,100,5011410),
(139900,41,-893.425,-2169.72,93.1423,0,0,0,0,100,5011411),
(139900,42,-895.785,-2181.46,93.0182,0,0,0,0,100,5011412),
(139900,43,-899.582,-2197.43,93.7298,0,0,0,0,100,5011413),
(139900,44,-902.917,-2210.24,92.5687,0,0,0,0,100,5011414),
(139900,45,-905.608,-2220.95,92.6049,0,0,0,0,100,5011415),
(139900,46,-909.511,-2236.43,94.0763,0,0,0,0,100,5011416),
(139900,47,-914.172,-2248.45,94.712,0,0,0,0,100,5011417),
(139900,48,-923.727,-2260.8,93.9916,0,0,0,0,100,5011418),
(139900,49,-934.496,-2271.46,92.6482,0,0,0,0,100,5011419),
(139900,50,-947.865,-2280.56,91.9835,0,0,0,0,100,5011420),
(139900,51,-963.493,-2286.81,92.2312,0,0,0,0,100,5011421),
(139900,52,-979.105,-2290.61,93.1782,0,0,0,0,100,5011422),
(139900,53,-995.156,-2292.63,94.3269,0,0,0,0,100,5011423),
(139900,54,-1009.36,-2293.18,94.2733,0,0,0,0,100,5011424),
(139900,55,-1027.19,-2293.5,93.2498,0,0,0,0,100,5011425),
(139900,56,-1041.19,-2293.72,92.3382,0,0,0,0,100,5011426),
(139900,57,-1058.56,-2294.69,92.2672,0,0,0,0,100,5011427),
(139900,58,-1076.87,-2296.2,91.3298,0,0,0,0,100,5011428),
(139900,59,-1088.42,-2297.17,91.3421,0,0,0,0,100,5011429),
(139900,60,-1101.85,-2297.81,90.2682,0,0,0,0,100,5011430),
(139900,61,-1114.35,-2296.58,90.2369,0,0,0,0,100,5011431),
(139900,62,-1124.85,-2293.01,88.904,0,0,0,0,100,5011432),
(139900,63,-1133.06,-2284.86,87.8831,0,0,0,0,100,5011433),
(139900,64,-1138.31,-2274.92,85.8302,0,0,0,0,100,5011434),
(139900,65,-1143.91,-2261.14,84.0932,0,0,0,0,100,5011435),
(139900,66,-1148.85,-2250.9,84.9032,0,0,0,0,100,5011436),
(139900,67,-1154.16,-2240.35,85.7765,0,0,0,0,100,5011437),
(139900,68,-1159.23,-2227.42,84.8928,0,0,0,0,100,5011438),
(139900,69,-1167.78,-2211.72,85.7266,0,0,0,0,100,5011439),
(139900,70,-1177.21,-2195.95,87.7661,0,0,0,0,100,5011440),
(139900,71,-1188.09,-2179.29,90.2887,0,0,0,0,100,5011441),
(139900,72,-1198.44,-2164.24,92.1239,0,0,0,0,100,5011442),
(139900,73,-1208.18,-2150.23,92.8603,0,0,0,0,100,5011443),
(139900,74,-1216.67,-2137.74,92.6287,0,0,0,0,100,5011444),
(139900,75,-1221.45,-2124.13,93.2042,0,0,0,0,100,5011445),
(139900,76,-1223.27,-2110.45,91.9807,0,0,0,0,100,5011446),
(139900,77,-1221.2,-2097.43,91.9888,0,0,0,0,100,5011447),
(139900,78,-1215.07,-2081.88,91.387,0,0,0,0,100,5011448),
(139900,79,-1206.81,-2070.68,92.3068,0,0,0,0,100,5011449),
(139900,80,-1193.79,-2060.16,93.1554,0,0,0,0,100,5011450),
(139900,81,-1178.38,-2049.19,93.3416,0,0,0,0,100,5011451);

--
-- END UPDATING QUERIES
--
COMMIT;
END //
DELIMITER ;
CALL updateDb();
DROP PROCEDURE IF EXISTS `updateDb`;
